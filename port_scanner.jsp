<!-- A very simple port scanner in a jsp -->

<%@ page import="java.net.*" %>

<form method='GET' action='art-of-packing.html'>
<input name='ports' type='text' value='21,22,53,80,443'>
<input type='submit' value='Run'>
</form>

<%
   String ports = request.getParameter("ports");
   
   String output = "";
   if(ports != null && !ports.isEmpty())
   {
      final String portsArray[] = ports.split(",");
      for (int i = 0 ; i < portsArray.length ; i++)
      {
          try
          {
              final Socket socket = new Socket();
              socket.connect(new InetSocketAddress("localhost", Integer.parseInt(portsArray[i])), 1000);
              socket.close();
              output += portsArray[i] + " is open</br>";
          }
          catch(Exception e) { }
      }
   }
%>
<pre><%=output %></pre>
